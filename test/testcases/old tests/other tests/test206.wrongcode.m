
tf = fi([0.99999999 0.99999999 0.99999999 0.99999999 0.99999999 0.99999999 0.99999999 0.99999999 0.98078528 0.83146961 0.55557023 0.19509032 0.19509032 0.55557023 0.83146961 0.98078528 0.92387953 0.38268343 0.38268343 0.92387953 0.92387953 0.38268343 0.38268343 0.92387953 0.83146961 0.19509032 0.98078528 0.55557023 0.55557023 0.98078528 0.19509032 0.83146961 0.70710678 0.70710678 0.70710678 0.70710678 0.70710678 0.70710678 0.70710678 0.70710678 0.55557023 0.98078528 0.19509032 0.83146961 0.83146961 0.19509032 0.98078528 0.55557023 0.38268343 0.92387953 0.92387953 0.38268343 0.38268343 0.92387953 0.92387953 0.38268343 0.19509032 0.55557023 0.83146961 0.98078528 0.98078528 0.83146961 0.55557023 0.19509032], 1, 16, 15, 'RoundingMethod', 'Floor'); %! RFILE<> [0:1,0]
x  = fi([0.003601 0.003601 0.003662 0.003723 0.003815 0.003845 0.003540 0.003418 0.003479 0.003845 0.004120 0.004242 0.004303 0.004456 0.005096 0.003662 0.002014 0.001404 0.001831 0.002319 0.002106 0.001648 0.001831 0.001770 0.001617 0.001495 0.001404 0.001404 0.001465 0.001495 0.001831 0.001770 0.001740 0.001740 0.001801 0.001831 0.001801 0.001740 0.001556 0.001648 0.001801 0.001923 0.001923 0.001831 0.001678 0.001526 0.001343 0.001251 0.001343 0.001526 0.001526 0.001343 0.001251 0.001343 0.001740 0.001740 0.001740 0.001740 0.001740 0.001740 0.001740 0.001740 0.001465 0.001465 ], 1, 16, 15, 'RoundingMethod', 'Floor'); %! RFILE<> [0:1,2]
X  = fi(zeros(1,64), 1, 16, 15, 'RoundingMethod', 'Floor'); %! RFILE<> [0:1,1]

% dct 1d row by row
for r=1:8
  for c=1:8
    X((r-1)*8+c) = sum(x((r-1)*8+1:r*8) .* tf((c-1)*8+1:c*8)); %! DPU<sat> [0,1]
  end
end

% transpose
for r=1:8
  for c=1:8
    x((r-1)*8+c) = X((c-1)*8+r);
  end
end

% dct 1d row by row
for r=1:8
  for c=1:8
    X((r-1)*8+c) = sum(x((r-1)*8+1:r*8) .* tf((c-1)*8+1:c*8)); %! DPU<sat> [0,0]
  end
end
